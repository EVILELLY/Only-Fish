<head>
  <title>邮件管理页面</title>
  <style>
    body {
      background: linear-gradient(135deg, #e3f0ff 0%, #b3cfff 100%);
      font-family: 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', Arial, sans-serif;
      min-height: 100vh;
    }
    .blue-container {
      max-width: 700px;
      margin: 40px auto 0 auto;
      background: rgba(255,255,255,0.97);
      border-radius: 16px;
      box-shadow: 0 8px 32px 0 rgba(31,38,135,0.10);
      padding: 36px 36px 24px 36px;
      border: 1.5px solid #c3d0e6;
    }
    h2 {
      text-align: center;
      font-weight: 600;
      color: #2566d8;
      letter-spacing: 2px;
      margin-bottom: 28px;
      text-shadow: 0 2px 8px #e3f0ff;
    }
    fieldset {
      border-radius: 10px;
      border: 1.5px solid #b3cfff;
      background: #f7fbff;
      margin-bottom: 18px;
      box-shadow: 0 2px 8px #e6eaf1;
    }
    legend {
      color: #2566d8;
      font-weight: bold;
      letter-spacing: 1px;
    }
    input[type="text"], input[type="password"], select, textarea {
      border: 1.5px solid #b3cfff;
      border-radius: 6px;
      padding: 6px 10px;
      font-size: 15px;
      background: #fff;
      margin: 4px 0 8px 0;
      outline: none;
      transition: border 0.2s, box-shadow 0.2s;
      box-shadow: 0 1px 4px #e6eaf1;
    }
    input[type="text"]:focus, input[type="password"]:focus, select:focus, textarea:focus {
      border: 1.5px solid #2566d8;
      box-shadow: 0 0 8px #e3f0ff;
    }
    button {
      background: linear-gradient(90deg, #4f8cff 0%, #2566d8 100%);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 7px 20px;
      font-size: 15px;
      font-weight: 500;
      margin-top: 8px;
      margin-right: 8px;
      cursor: pointer;
      box-shadow: 0 2px 8px #e6eaf1;
      transition: background 0.2s, color 0.2s;
    }
    button:hover {
      background: linear-gradient(90deg, #2566d8 0%, #4f8cff 100%);
      color: #fff;
    }
    .template-preview {
      border-radius: 10px;
      background: #f7fbff;
      box-shadow: 0 2px 8px #e6eaf1;
      padding: 18px;
      margin-top: 24px;
    }
    .template-preview h3 {
      color: #2566d8;
      margin-bottom: 12px;
    }
    .send-result {
      margin-top: 20px;
      color: #2566d8;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>

<body>
<div class="blue-container">
  <h2>钓鱼邮件管理</h2>
  <form method="post" enctype="multipart/form-data" style="margin-bottom:20px;">
    <fieldset>
      <legend>发件配置</legend>
      <div style="margin-bottom:10px;">
        SMTP服务器：<input type="text" name="smtp_server" value="{{ smtp_server }}" style="width:180px;">
        端口：<input type="text" name="smtp_port" value="{{ smtp_port }}" style="width:60px;">
      </div>
      <div style="margin-bottom:10px;">
        发件人邮箱：<input type="text" name="sender_email" value="{{ sender_email }}" style="width:180px;">
        授权码：<input type="password" name="sender_pass" value="{{ sender_pass }}" style="width:120px;">
      </div>
      <div style="margin-bottom:10px;">
        发件人名称：<input type="text" name="sender_name" value="{{ sender_name }}" style="width:180px;">
        邮件主题：<input type="text" name="mail_subject" value="{{ mail_subject }}" style="width:220px;">
      </div>
      <button type="submit" name="action" value="save_config">保存配置</button>
    </fieldset>
    <fieldset>
      <legend>邮件模板</legend>
      <select name="template_name" style="width:220px;">
        {% for t in templates %}
        <option value="{{ t }}" {% if t==template_name %}selected{% endif %}>{{ t }}</option>
        {% endfor %}
      </select>
      <button type="submit" name="action" value="preview_template">预览</button>
    </fieldset>
    <fieldset>
      <legend>收信人管理</legend>
      <textarea name="recipients" rows="4" style="width:400px;" placeholder="每行一个邮箱地址，例如：&#10;user1@example.com&#10;user2@example.com">{{ recipients }}</textarea>
      <br>
      <span style="color:#888;">或导入CSV：</span>
      <input type="file" name="recipients_file">
      <button type="submit" name="action" value="import_recipients">导入</button>
      <button type="submit" name="action" value="clear_recipients" style="margin-left:10px;">清空</button>
    </fieldset>
    <button type="submit" name="action" value="send_mail" style="font-size:16px;padding:6px 18px;">一键发送钓鱼邮件</button>
  </form>


  {% if template_html %}
  <div class="template-preview">
    <h3>模板预览：</h3>
    <div style="background:#fff;max-width:600px;overflow:auto;">{{ template_html|safe }}</div>
  </div>
  {% endif %}

  {% if send_result %}
  <div class="send-result">{{ send_result }}</div>
  {% endif %}
  </div>
  </body>
